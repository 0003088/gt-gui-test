Name:          elektra
Version:       _VERSION_
%define myRelease 13
%define vepoch 1
Release:       0.fdr.%{vepoch}.%{myRelease}
Source:        http://aleron.dl.sourceforge.net/sourceforge/elektra/%{name}-%{version}.tar.gz
Group:         System Environment/Libraries
License:       BSD
URL:           http://elektra.sourceforge.net
BuildRoot:     %{_tmppath}/%{name}-%{version}-build
BuildRequires: doxygen libxml2-devel /usr/bin/xsltproc
Summary:       A key/value pair database to store software configurations

%description
The Elektra Project provides a framework to store generic configuration data
in an hierarchical key-value pair database, instead of a human-readable only
text file.

This way any software can read/save his configuration using a consistent API.
Also, applications can be aware of other applications configurations,
leveraging easy application integration.


%package devel
Summary:      Include files and API documentation for Elektra Project
Group:        Development/System
Requires:     elektra = %{version}-%{release}

%description devel
The Elektra Project provides a framework to store generic configuration data
in an hierarchical key-value pair database, instead of a human-readable only
text file.

This way any software can read/save his configuration using a consistent API.
Also, applications can be aware of other applications configurations,
leveraging easy application integration.

This package contains the include files and API manual pages to use the Elektra
API in C.

%prep
%setup
%build
# Setup for parallel builds
numprocs=`egrep -c ^cpu[0-9]+ /proc/stat || :`
if [ "$numprocs" = "0" ]; then
	numprocs=1
fi

gmake OPTIMIZATIONS="$RPM_OPT_FLAGS" \
	%{?_smp_mflags} \
	UBINDIR=%{_bindir} \
	ULIBDIR=%{_libdir} \
	CONFDIR=%{_sysconfdir} \
	INCDIR=%{_includedir} \
	DOCDIR=%{_docdir} \
	MANDIR=%{_mandir} \
	SGMLDIR=%{_datadir}/sgml \
	all

%install
rm -rf $RPM_BUILD_ROOT
gmake  %{?_smp_mflags} \
	DESTDIR=$RPM_BUILD_ROOT \
	UBINDIR=%{_bindir} \
	ULIBDIR=%{_libdir} \
	CONFDIR=%{_sysconfdir} \
	INCDIR=%{_includedir} \
	DOCDIR=%{_docdir} \
	MANDIR=%{_mandir} \
	SGMLDIR=%{_datadir}/sgml \
	install

%clean
rm -rf $RPM_BUILD_ROOT
#rm -rf $RPM_BUILD_DIR/%{name}




%post
/sbin/ldconfig
# Backwards compatibility, from the Linux Registry days
if [ -d /etc/registry -a ! -d /etc/kdb ]; then
	mv /etc/registry /etc/kdb
	ln -s kdb /etc/registry
fi

# Create basic key structure for apps
kdb set -t dir system/sw


%postun -p /sbin/ldconfig



%files
%defattr(-,root,root,0755)
/lib/*.so
/bin/*
%{_sysconfdir}/profile.d/*
%doc %{_docdir}/%{name}
%doc %{_mandir}/man1/*
%doc %{_mandir}/man7/*
%doc %{_mandir}/man5/*
%{_datadir}/sgml/*



%files devel
%defattr(-,root,root,0755)
%{_includedir}/*
%{_libdir}/*.a
%{_libdir}/pkgconfig/*
%doc %{_docdir}/%{name}-devel
%doc %{_mandir}/man3/*

%changelog
