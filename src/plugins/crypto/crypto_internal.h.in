/**
 * @file
 *
 * @brief internal header for crypto.h
 *
 * @copyright BSD License (see doc/COPYING or http://www.libelektra.org)
 *
 */

#ifndef ELEKTRA_PLUGIN_CRYPTO_H_INTERNAL
#define ELEKTRA_PLUGIN_CRYPTO_H_INTERNAL

#cmakedefine ELEKTRA_CRYPTO_API_GCRYPT
#cmakedefine ELEKTRA_CRYPTO_API_OPENSSL

enum ElektraCryptoHeaderFlags
{
	ELEKTRA_CRYPTO_FLAG_NONE = 0,
	ELEKTRA_CRYPTO_FLAG_STRING = 1,
	ELEKTRA_CRYPTO_FLAG_NULL = 2
};

struct ElektraCryptoHeader
{
	unsigned short flags;
	unsigned long contentLen;
};

#define ELEKTRA_CRYPTO_META_ENCRYPT ("crypto/encrypt")
#define ELEKTRA_CRYPTO_META_ENCRYPTED ("crypto/encrypted")

// gcrypt specific declarations
#ifdef ELEKTRA_CRYPTO_API_GCRYPT

#include <gcrypt.h>
typedef gcry_cipher_hd_t elektraCryptoHandle;

#endif

// libcrypto (OpenSSL) specific declarations
#ifdef ELEKTRA_CRYPTO_API_OPENSSL

// TODO use an appropriate type for libcrypto
typedef unsigned int elektraCryptoHandle;

#endif

#endif
