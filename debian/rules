#!/usr/bin/make -f

# Uncomment this to turn on verbose mode.
export DH_VERBOSE=1

ELEKTRA_PLUGINS="dump;resolver;hidden;iconv;syslog;error;ccode;hosts;tracer;fstab;network;null;path;simpleini;ni;success;tcl;timeofday;type;xmltool"
#ELEKTRA_PLUGINS="dump;resolver;hidden;iconv;syslog;error;validation;xmltool;tracer;timeofday;dbus;glob;hosts;network;type;struct;path;fstab;ccode;simpleini;ni;tcl;hexcode;null"
#build everything:
#ELEKTRA_PLUGINS="ALL"

# Make sure libelektra is built before packages depending on it
binary/libelektra-bin binary/libelektra-dev:: binary/libelektra

CMAKE_FLAGS = \
	-DCMAKE_INSTALL_PREFIX=/usr \
	-DTARGET_PLUGIN_FOLDER=elektra4 \
	-DPLUGINS=$(ELEKTRA_PLUGINS) \
	-DKDB_DB_SYSTEM:PATH="/etc/kdb" \
	-DKDB_DB_HOME:PATH="/home" \
	-DKDB_DB_USER:PATH=".kdb" \
	-DENABLE_KDB_TESTING=OFF

%:
	dh $@ --buildsystem=cmake --parallel

override_dh_auto_configure:
	dh_auto_configure -- $(CMAKE_FLAGS)
